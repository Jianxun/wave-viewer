schema_version: 2
current_sprint:
  - id: T-050
    title: Replace spec contract with YAML layout schema v2 only (drop v1 + mode)
    owner: Executor
    dod:
      - Replace current plot spec schema/contracts with v2-only layout schema (`version: 2`) using `dataset.path`, `active_plot`, per-plot `x`, and lane-grouped `signals`.
      - Remove `mode` and `portable-archive` handling from spec parser/exporter paths.
      - Reject unsupported schema versions (including v1) with actionable errors.
    verify:
      - npm test -- tests/unit/core/spec/importSpec.test.ts tests/unit/core/spec/exportSpec.test.ts
      - npm run lint
    links:
      scratchpad: agents/scratchpads/T-050.md
      adr: agents/adr/ADR-0013-layout-schema-v2-human-editable-mvp-only.md
    files:
      - src/core/spec/plotSpecV1.ts
      - src/core/spec/importSpec.ts
      - src/core/spec/exportSpec.ts
      - tests/unit/core/spec/importSpec.test.ts
      - tests/unit/core/spec/exportSpec.test.ts
  - id: T-051
    title: Wire host layout workflows to v2 schema translation and defaults
    owner: Executor
    depends_on:
      - T-050
    dod:
      - Update open/save/save-as/autosave/external-reload flows to consume/produce v2 schema only.
      - Preserve host-internal canonical axis IDs (`y1..yN`) while mapping to/from user lane IDs in YAML.
      - Keep runtime behavior stable: external layout edits must continue to hydrate tuples before state patch.
    verify:
      - npm test -- tests/extension/smoke.test.ts
      - npm run lint
    links:
      scratchpad: agents/scratchpads/T-051.md
    files:
      - src/extension.ts
      - src/extension/commands.ts
      - src/extension/types.ts
      - tests/extension/smoke.test.ts
  - id: T-052
    title: Add frozen bundle export (separate frozen CSV + frozen layout YAML)
    owner: Executor
    depends_on:
      - T-050
      - T-051
    dod:
      - "Add command flow to export frozen bundle artifacts: `<name>.frozen.csv` and `<name>.frozen.wave-viewer.yaml`."
      - Ensure frozen export never rebinds or overwrites the active interactive layout/session.
      - Include required signal columns (all per-plot x signals + referenced y signals) deterministically in frozen CSV output.
    verify:
      - npm test -- tests/extension/smoke.test.ts
      - npm run lint
    links:
      scratchpad: agents/scratchpads/T-052.md
      adr: agents/adr/ADR-0014-frozen-bundle-artifacts-supersede-dual-modes.md
    files:
      - src/extension.ts
      - src/extension/commands.ts
      - src/core/csv/parseCsv.ts
      - src/core/spec/exportSpec.ts
      - package.json
      - tests/extension/smoke.test.ts
  - id: T-053
    title: Refresh test/docs baseline for v2-only schema and frozen workflow
    owner: Executor
    depends_on:
      - T-050
      - T-051
      - T-052
    dod:
      - Replace stale v1/dual-mode fixtures and assertions in unit/smoke tests with v2 equivalents.
      - Add explicit coverage for unsupported v1 imports and no-`mode` v2 parsing rules.
      - Update user-facing docs/spec references to the final v2 + frozen bundle workflow.
    verify:
      - npm test -- tests/unit/core/spec/importSpec.test.ts tests/unit/core/spec/exportSpec.test.ts
      - npm test -- tests/extension/smoke.test.ts
      - npm run lint
    links:
      scratchpad: agents/scratchpads/T-053.md
    files:
      - tests/unit/core/spec/importSpec.test.ts
      - tests/unit/core/spec/exportSpec.test.ts
      - tests/extension/smoke.test.ts
      - doc/specs/wave-viewer-mvp.md
      - agents/context/contract.md
backlog: []
exploration_candidates:
  - Evaluate adding a one-shot CLI migrator from legacy v1 layout YAML to v2 outside MVP core scope.
  - Evaluate migrating Wave Viewer from command-opened panel to custom editor architecture (`viewType`) only after host-authoritative protocol migration is complete.
  - Evaluate grouped signal tree taxonomy (flat vs prefix-grouped) for large datasets.
  - Evaluate decimation strategy for large CSV files under side-panel-driven multi-trace workflows.

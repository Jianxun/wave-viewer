schema_version: 2
current_sprint:
  - id: T-020
    title: Persist single-session loaded CSV registry for side-panel signal browser
    owner: Executor
    dod:
      - Replace active-editor-derived signal listing with an explicit in-memory loaded-dataset registry for one Wave Viewer session.
      - Keep Explorer tree populated when focus moves from CSV editor to webview or other editors.
      - Render loaded files as parent nodes with signal children so signal actions can be scoped to a concrete loaded file.
      - Ensure existing side-panel signal actions continue to work against the selected dataset node context.
    verify:
      - npm run lint
      - npm test -- tests/extension/smoke.test.ts tests/unit/webview/workspaceState.test.ts
    links:
      scratchpad: agents/scratchpads/T-020.md
      spec: doc/specs/side-panel-workflow.md
      adr: agents/adr/ADR-0003-side-panel-first-workflow.md
    files:
      - src/extension.ts
      - src/extension/signalTree.ts
      - src/core/csv/parseCsv.ts
      - tests/extension/smoke.test.ts
      - agents/scratchpads/T-020.md
  - id: T-021
    title: Add Explorer context menu actions to load CSV and reload all loaded files
    owner: Executor
    depends_on:
      - T-020
    dod:
      - Add Explorer view context-menu command `Load CSV File...` that opens a file picker and loads one or more CSV files into the side-panel registry.
      - Add Explorer view context-menu command `Reload All Files` that reparses all currently loaded CSV files and refreshes tree content.
      - Surface actionable errors for parse failures while preserving already-loaded valid datasets.
      - Keep command wiring deterministic and covered by extension smoke tests.
    verify:
      - npm run lint
      - npm test -- tests/extension/smoke.test.ts
    links:
      scratchpad: agents/scratchpads/T-021.md
      spec: doc/specs/side-panel-workflow.md
      adr: agents/adr/ADR-0003-side-panel-first-workflow.md
    files:
      - package.json
      - src/extension.ts
      - src/extension/signalTree.ts
      - tests/extension/smoke.test.ts
      - agents/scratchpads/T-021.md
  - id: T-022
    title: Add Explorer context menu action to remove loaded file and keep workflow stable
    owner: Executor
    depends_on:
      - T-021
    dod:
      - Add file-node context-menu command `Remove Loaded File` that removes exactly one loaded dataset from the registry and tree.
      - Ensure removing a loaded file updates related side-panel interactions without clearing unrelated loaded datasets.
      - If removed file has an open viewer panel, keep panel behavior predictable (show warning and block new side-panel adds for that dataset).
      - Add regression checks for remove-file behavior and follow-up signal actions.
    verify:
      - npm run lint
      - npm test -- tests/extension/smoke.test.ts tests/unit/webview/workspaceState.test.ts
    links:
      scratchpad: agents/scratchpads/T-022.md
      spec: doc/specs/side-panel-workflow.md
      adr: agents/adr/ADR-0003-side-panel-first-workflow.md
    files:
      - package.json
      - src/extension.ts
      - src/extension/signalTree.ts
      - tests/extension/smoke.test.ts
      - tests/unit/webview/workspaceState.test.ts
      - agents/scratchpads/T-022.md
  - id: T-023
    title: Fix Plotly interaction regression caused by canvas drop overlay hit-testing
    owner: Executor
    depends_on:
      - T-022
    dod:
      - Ensure Plotly canvas interactions remain fully functional when no drag operation is active: legend click toggles traces, hover cursor/tooltip behavior, pan/zoom interactions.
      - Update canvas drop-overlay styling/behavior so overlay lanes never intercept pointer events outside active drag handling.
      - If drag feedback requires interaction state, gate overlay visibility/activation to drag lifecycle events only (`dragenter`/`dragover`/`dragleave`/`drop`).
      - Keep canvas overlay lane highlighting behavior intact during valid signal drag operations.
      - Add regression coverage that validates overlay elements do not block normal plot interactions.
    verify:
      - npm run lint
      - npm test -- tests/unit/webview/plotly/adapter.test.ts tests/extension/smoke.test.ts
    links:
      scratchpad: agents/scratchpads/T-023.md
      spec: doc/specs/side-panel-workflow.md
      adr: agents/adr/ADR-0003-side-panel-first-workflow.md
    files:
      - src/webview/styles.css
      - src/webview/main.ts
      - src/webview/index.html
      - tests/extension/smoke.test.ts
      - agents/scratchpads/T-023.md
  - id: T-024
    title: Stabilize shared x-axis anchoring independent of lane reorder
    owner: Executor
    dod:
      - Decouple shared x-axis anchoring from workspace axis identity/order so x-axis ticks do not move when lanes reorder.
      - Introduce a render-layer axis mapping strategy that preserves workspace axis ids (`y1..yN`) while assigning non-overlapping Plotly lane domains deterministically.
      - Ensure add/remove/reorder axis operations keep lane rendering stable and preserve existing drag/drop lane targeting semantics.
      - Add regression coverage proving x-axis tick placement remains stable across axis reorder operations.
    verify:
      - npm run lint
      - npm test -- tests/unit/webview/plotly/adapter.test.ts tests/unit/webview/workspaceState.test.ts tests/extension/smoke.test.ts
    links:
      scratchpad: agents/scratchpads/T-024.md
      spec: doc/specs/domain-stacked-shared-x-implementation.md
      adr: agents/adr/ADR-0002-domain-stacked-yaxes-shared-x.md
    files:
      - src/webview/plotly/adapter.ts
      - src/webview/plotly/renderPlot.ts
      - src/webview/main.ts
      - tests/unit/webview/plotly/adapter.test.ts
      - tests/extension/smoke.test.ts
      - agents/scratchpads/T-024.md
backlog: []
exploration_candidates:
  - Evaluate migrating Wave Viewer from command-opened panel to custom editor architecture (`viewType`) only after side-panel workflow stabilization criteria are met.
  - Evaluate grouped signal tree taxonomy (flat vs prefix-grouped) for large datasets.
  - Evaluate decimation strategy for large CSV files under side-panel-driven multi-trace workflows.

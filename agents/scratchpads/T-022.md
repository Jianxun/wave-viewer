# T-022 â€” Add Explorer context menu action to remove loaded file and keep workflow stable

## Task summary (DoD + verify)
- Add file-node context-menu command `Remove Loaded File` that removes exactly one loaded dataset from the registry and tree.
- Ensure removing a loaded file updates related side-panel interactions without clearing unrelated loaded datasets.
- If removed file has an open viewer panel, keep panel behavior predictable (show warning and block new side-panel adds for that dataset).
- Add regression checks for remove-file behavior and follow-up signal actions.

Verify:
- `npm run lint`
- `npm test -- tests/extension/smoke.test.ts tests/unit/webview/workspaceState.test.ts`

## Read (paths)
- `agents/context/lessons.md`
- `agents/context/contract.md`
- `agents/context/tasks.yaml`
- `agents/context/tasks_state.yaml`
- `agents/context/project_status.md`

## Plan
- Inspect current loaded-registry and side-panel command wiring from T-020/T-021.
- Add remove-loaded-file command wiring + dataset removal behavior with predictable warning handling.
- Add/adjust smoke tests for remove command and follow-up signal actions.
- Run verify commands and close out state + PR metadata.

## Milestone notes
- Intake complete.
- Implemented `Remove Loaded File` command wiring, removed-dataset guardrails for side-panel actions, and T-022 regression tests.
- Verified with `npm run lint` and targeted test command.

## Patch summary
- Added `waveViewer.signalBrowser.removeLoadedFile` command in extension + signal tree plumbing and Explorer dataset-node context menu contribution.
- Added removed-dataset tombstone tracking so removed files are blocked for side-panel add actions with clear warning messaging, including open-panel removal warning behavior.
- Added smoke tests for remove behavior and follow-up action blocking on removed dataset context.

## PR URL
- Pending.

## Verification
- `npm run lint` (pass)
- `npm test -- tests/extension/smoke.test.ts tests/unit/webview/workspaceState.test.ts` (pass)

## Status request (Done / Blocked / In Progress)
- In Progress

## Blockers / Questions
- None.

## Next steps
- Implement command + tests.

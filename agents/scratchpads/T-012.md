# T-012 Scratchpad

## Task summary (DoD + verify)
- DoD:
  - Update e2e smoke scenario to verify stacked non-overlapping lanes and shared rangeslider behavior.
  - Refresh README workflow language to match lane terminology and controls.
  - Add regression assertions that prevent fallback to overlay-axis behavior.
  - Record known limits and follow-up items in docs (without expanding MVP scope).
- Verify:
  - `npm run lint`
  - `npm test`
  - `npm run test:e2e`

## Read (paths)
- agents/context/contract.md
- agents/context/lessons.md
- agents/context/project_status.md
- agents/context/tasks.yaml
- agents/context/tasks_state.yaml
- agents/roles/executor.md
- doc/specs/domain-stacked-shared-x-implementation.md
- doc/specs/wave-viewer-mvp.md
- README.md
- tests/e2e/waveViewerReplay.test.ts
- tests/extension/smoke.test.ts

## Plan
- Extend replay e2e assertions to verify shared `xaxis`+rangeslider, stacked domains, and no `overlaying` fallback.
- Add a smoke-level guard that extension host payload remains dataset-only.
- Refresh README/MVP wording for lane semantics and document known MVP limits/follow-ups.
- Run full verify suite, then hand off with task-state + PR metadata.

## Milestone notes
- Intake: `T-012` was `ready`; set to `in_progress` and linted task state.
- Subtask 1 complete: regression tests added and validated with targeted vitest run.
- Subtask 2 complete: docs updated for lane terminology, known limits, and follow-up items.
- Full verification complete: lint, full test suite, and e2e suite all passed.

## Patch summary
- `tests/e2e/waveViewerReplay.test.ts`
  - Added replay-time rendering assertions for one shared `xaxis`, visible shared rangeslider, non-overlapping stacked lane domains, and no `overlaying` keys.
  - Renamed suite label to `T-012 e2e replay smoke`.
- `tests/extension/smoke.test.ts`
  - Added host payload guard asserting no precomputed `layout`/`axes` fields in `host/datasetLoaded`.
- `README.md`
  - Updated workflow language from generic axes wording to lane-oriented controls and shared rangeslider behavior.
  - Added MVP known limits and post-MVP follow-up bullets.
- `doc/specs/wave-viewer-mvp.md`
  - Added explicit MVP known limits section and retained follow-ups as post-MVP candidates.

## PR URL
- Pending PR creation.

## Verification
- `./venv/bin/python scripts/lint_tasks_state.py` -> `OK: tasks.yaml and tasks_state.yaml are consistent.`
- `npx vitest run tests/e2e/waveViewerReplay.test.ts tests/extension/smoke.test.ts` -> 2 files passed, 7 tests passed.
- `npm run lint` -> pass.
- `npm test` -> 9 files passed, 41 tests passed.
- `npm run test:e2e` -> 1 file passed, 1 test passed.

## Status request
- Ready for Review (pending PR number update in `tasks_state.yaml`)

## Blockers / Questions
- None.

## Next steps
- Push branch and open PR to `main`.
- Set `T-012` to `ready_for_review` with PR number in `agents/context/tasks_state.yaml` and lint task state.

# T-007 Scratchpad

## Task summary (DoD + verify)
- DoD:
  - Add smoke test flow that opens `examples/simulations/ota.spice.csv`, creates 2 tabs, and assigns signals to multiple axes.
  - Validate export/import replay yields equivalent tab/trace/axis state.
  - Document usage workflow for open -> explore -> export -> replay.
- Verify:
  - `npm run lint`
  - `npm test`
  - `npm run test:e2e`

## Read (paths)
- `agents/roles/executor.md`
- `agents/context/lessons.md`
- `agents/context/contract.md`
- `agents/context/tasks.yaml`
- `agents/context/tasks_state.yaml`
- `agents/context/project_status.md`
- `doc/specs/wave-viewer-mvp.md`
- `src/extension.ts`
- `src/webview/state/workspaceState.ts`
- `src/webview/state/reducer.ts`
- `src/core/spec/exportSpec.ts`
- `src/core/spec/importSpec.ts`
- `tests/unit/spec/roundtrip.test.ts`

## Plan
1. Add failing replay smoke test around `ota.spice.csv` with 2 tabs and multi-axis trace assignment.
2. Ensure `test:e2e` command is wired to execute this flow.
3. Add README usage documentation for open/explore/export/replay workflow.
4. Run verification, update state/scratchpad, push branch, and open PR.

## Milestone notes
- 2026-02-11: Intake complete; selected `T-007`, created branch, set task to `in_progress`, and created scratchpad.
- 2026-02-11: Added `tests/e2e/waveViewerReplay.test.ts` covering `ota.spice.csv` load, two-tab workspace edits, multi-axis trace assignments, and export/import replay equivalence.
- 2026-02-11: Added `npm run test:e2e` script targeting `tests/e2e`.
- 2026-02-11: Added README usage workflow for open -> explore -> export -> replay.
- 2026-02-11: Ran all verification commands successfully.

## Patch summary
- Added `tests/e2e/waveViewerReplay.test.ts`:
  - reads `examples/simulations/ota.spice.csv`,
  - parses dataset + computes default X signal,
  - simulates workspace exploration via reducer actions (2 plots, multiple axes, repeated signal on different axes),
  - exports YAML spec and imports it back, asserting equivalent workspace state.
- Updated `package.json` with `test:e2e` script: `vitest run tests/e2e`.
- Added `README.md` with user workflow and verification commands.

## PR URL
- Pending PR open.

## Verification
- `./venv/bin/python scripts/lint_tasks_state.py` passed.
- `npm run lint` passed.
- `npm test` passed (`29` tests across `8` files).
- `npm run test:e2e` passed (`1` test across `1` file).

## Status request
- Ready for Review (pending PR open and tasks-state PR update).

## Blockers / Questions
- None currently.

## Next steps
- Push branch, open PR to `main`, set `T-007` `pr` and `status=ready_for_review`, then hand off to Reviewer.

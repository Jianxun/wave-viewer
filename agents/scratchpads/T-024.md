# T-024 â€” Stabilize shared x-axis anchoring independent of lane reorder

## Task summary (DoD + verify)
- Decouple shared x-axis anchoring from workspace axis identity/order so x-axis ticks do not move when lanes reorder.
- Introduce a render-layer axis mapping strategy that preserves workspace axis ids (`y1..yN`) while assigning non-overlapping Plotly lane domains deterministically.
- Ensure add/remove/reorder axis operations keep lane rendering stable and preserve existing drag/drop lane targeting semantics.
- Add regression coverage proving x-axis tick placement remains stable across axis reorder operations.

Verify:
- `npm run lint`
- `npm test -- tests/unit/webview/plotly/adapter.test.ts tests/unit/webview/workspaceState.test.ts tests/extension/smoke.test.ts`

## Read (paths)
- `agents/context/lessons.md`
- `agents/context/contract.md`
- `agents/context/tasks.yaml`
- `agents/context/tasks_state.yaml`
- `agents/context/project_status.md`
- `doc/specs/domain-stacked-shared-x-implementation.md`
- `agents/adr/ADR-0002-domain-stacked-yaxes-shared-x.md`
- `src/webview/plotly/adapter.ts`
- `src/webview/plotly/renderPlot.ts`
- `src/webview/main.ts`
- `tests/unit/webview/plotly/adapter.test.ts`
- `tests/unit/webview/workspaceState.test.ts`
- `tests/extension/smoke.test.ts`

## Plan
- Add render-layer axis mapping in Plotly adapter that maps axis IDs to lane-based Plotly refs/layout keys.
- Ensure relayout parsing uses the same mapping and x-axis anchoring is fixed independent of workspace axis IDs.
- Add/adjust unit regression tests for reorder stability and drop-lane semantics.
- Run verify commands and close out task state/PR handoff.

## Milestone notes
- Intake complete; task moved to in-progress.

## Patch summary
- Pending.

## PR URL
- Pending.

## Verification
- Pending.

## Status request
- In Progress

## Blockers / Questions
- None.

## Next steps
- Implement adapter mapping + tests.

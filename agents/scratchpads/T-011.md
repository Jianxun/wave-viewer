# T-011 Scratchpad

## Task summary (DoD + verify)
- DoD:
- Update spec schema/types to represent domain-stacked lane semantics.
- Keep deterministic ordering guarantees for plots, axes, and traces.
- Define explicit handling for legacy specs (clear error or controlled migration path, documented in code/tests).
- Update import/export validation for axis references and missing signals.
- Verify:
- `npm run lint`
- `npm test -- tests/unit/spec/roundtrip.test.ts tests/unit/spec/importErrors.test.ts`

## Read (paths)
- doc/specs/domain-stacked-shared-x-implementation.md
- doc/specs/wave-viewer-mvp.md
- agents/context/contract.md
- agents/context/tasks.yaml
- agents/context/tasks_state.yaml
- agents/adr/ADR-0002-domain-stacked-yaxes-shared-x.md
- src/core/spec/plotSpecV1.ts
- src/core/spec/exportSpec.ts
- src/core/spec/importSpec.ts
- tests/unit/spec/roundtrip.test.ts
- tests/unit/spec/importErrors.test.ts

## Plan
- 1) Convert spec axis schema away from overlay-era `side`, and enforce legacy handling path in importer.
- 2) Update importer/exporter behavior and validation to match lane semantics while preserving deterministic order.
- 3) Update/extend roundtrip + import error tests first (TDD), then implement code to satisfy tests.
- 4) Run verify commands and capture outputs.
- 5) Prepare closeout notes and PR metadata.

## Milestone notes
- Intake complete: `T-011` is `ready`; dependency `T-010` is `done`.
- Task understanding: spec v1 should now model lane semantics (`axes[]` order as lane order, no `side` usage). Legacy `side` should be handled explicitly; for this task I will reject legacy specs with a clear actionable import error.

## Patch summary
- Pending.

## PR URL
- Pending.

## Verification
- Pending.

## Status request
- In Progress

## Blockers / Questions
- Pending.

## Next steps
- Pending.

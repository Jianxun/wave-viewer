# T-028 — Refactor viewer signal panel to show available and per-lane assigned signals

## Task summary (DoD + verify)
- Replace single flat signal list UX with sections that make lane assignment explicit (available signals + per-lane assignments).
- Ensure UI remains deterministic and consistent with reducer state after add/remove/reassign/reorder operations.
- Preserve existing drag/drop and quick-add functionality while updating signal display structure.
- Add unit/smoke checks for new signal panel rendering and interactions.

Verify:
- `npm run lint`
- `npm test -- tests/unit/webview/workspaceState.test.ts tests/extension/smoke.test.ts`

## Read (paths)
- `agents/context/lessons.md`
- `agents/context/contract.md`
- `agents/context/tasks.yaml`
- `agents/context/tasks_state.yaml`
- `agents/context/project_status.md`

## Plan
- Inspect current signal panel rendering and webview interactions.
- Add tests first for sectioned signal panel behavior.
- Implement sectioned panel UI while preserving existing add/remove/drag flows.
- Run required verification and record results.

## Milestone notes
- Intake complete: task selected and moved to `in_progress`.
- Added failing tests for sectioned signal panel model/wiring.
- Implemented signal panel refactor with available-signals and per-lane assigned-signal sections.
- Ran required verification commands successfully.

## Patch summary
- `src/webview/components/SignalList.ts`
  - Added deterministic `buildSignalPanelModel` helper that separates available signals and per-lane assigned signals by current axis order.
  - Refactored rendering from a flat list to explicit panel sections:
    - `Available Signals` (keeps add-trace selector/button and double-click quick-add).
    - `Assigned to YN (Lane M)` sections for each axis lane.
- `src/webview/main.ts`
  - Wired `activePlot.traces` into `renderSignalList` so lane sections stay consistent with reducer state.
- `src/webview/index.html`
  - Updated signal container aria label from `Signal list` to `Signal panel`.
- `src/webview/styles.css`
  - Added section styling for signal panel groups and assigned-signal rows.
- Tests:
  - Added `tests/unit/webview/signalList.test.ts` for deterministic lane-grouped model behavior across add/remove/reassign/reorder flows.
  - Added `T-028` smoke assertions in `tests/extension/smoke.test.ts` for panel structure/wiring guards.

## PR URL
- Pending PR creation.

## Verification
- `npm test -- tests/unit/webview/signalList.test.ts tests/extension/smoke.test.ts` ✅
- `npm run lint` ✅
- `npm test -- tests/unit/webview/workspaceState.test.ts tests/extension/smoke.test.ts` ✅

## Status request (Done / Blocked / In Progress)
- In Progress

## Blockers / Questions
- None.

## Next steps
- Push branch, open PR, and set task state to `ready_for_review` with PR number.

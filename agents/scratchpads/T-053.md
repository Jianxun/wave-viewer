# T-053 Scratchpad

## Task summary (DoD + verify)
- Title: Refresh test/docs baseline for v2-only schema and frozen workflow
- DoD:
  - Replace stale v1/dual-mode fixtures and assertions in unit/smoke tests with v2 equivalents.
  - Add explicit coverage for unsupported v1 imports and no-`mode` v2 parsing rules.
  - Update user-facing docs/spec references to the final v2 + frozen bundle workflow.
- Verify:
  - `npm test -- tests/unit/core/spec/importSpec.test.ts tests/unit/core/spec/exportSpec.test.ts`
  - `npm test -- tests/extension/smoke.test.ts`
  - `npm run lint`

## Read (paths)
- `agents/context/lessons.md`
- `agents/context/contract.md`
- `agents/context/tasks.yaml`
- `agents/context/tasks_state.yaml`
- `agents/context/project_status.md`

## Plan
- Audit scoped tests/docs for lingering v1/dual-mode assumptions.
- Update tests to v2-only + explicit v1 rejection coverage.
- Update docs for v2 layout and frozen export workflow.
- Run verify commands and close out state/PR metadata.

## Milestone notes
- Intake complete; task selected and context read.
- Added explicit import coverage for v2-without-mode acceptance and `mode` rejection.
- Replaced remaining smoke v1 fixture with v2.
- Refreshed MVP spec wording for v2 layout artifact + frozen bundle workflow.

## Patch summary
- `tests/unit/core/spec/importSpec.test.ts`
  - Added explicit test that v2 layouts parse when `mode` is absent.
  - Added explicit test that any `mode` field is rejected in v2.
- `tests/extension/smoke.test.ts`
  - Updated atomic write fixture content from `version: 1` to `version: 2`.
- `doc/specs/wave-viewer-mvp.md`
  - Updated terminology from legacy "plot spec" phrasing to v2 layout artifact workflow.
  - Corrected default X-signal rule to first dataset column by CSV header order.
  - Updated protocol test reference to `webview/intent/dropSignal`.

## PR URL
- Pending (to be filled from created PR URL during closeout).

## Verification
- `npm test -- tests/unit/core/spec/importSpec.test.ts` ✅
- `npm test -- tests/unit/core/spec/importSpec.test.ts tests/unit/core/spec/exportSpec.test.ts` ✅
- `npm test -- tests/extension/smoke.test.ts` ✅
- `npm run lint` ✅

## Status request (Done / Blocked / In Progress)
- Done

## Blockers / Questions
- None.

## Next steps
- Push branch, open PR to `main`, set `T-053` to `ready_for_review` with PR number.

# T-002 Scratchpad

## Task summary (DoD + verify)
- DoD:
  - Create extension scaffold with a command to open the viewer for active CSV file.
  - Build webview shell with left control pane and right plot canvas container.
  - Add plot-tab bar skeleton and active tab switching state in UI shell.
  - Wire message bridge between extension host and webview for dataset load/init events.
- Verify:
  - `npm run lint`
  - `npm test`

## Read (paths)
- `agents/roles/executor.md`
- `agents/context/lessons.md`
- `agents/context/contract.md`
- `agents/context/tasks.yaml`
- `agents/context/tasks_state.yaml`
- `agents/context/project_status.md`
- `doc/specs/wave-viewer-mvp.md`

## Plan
1. Scaffold extension + TypeScript build/test/lint baseline.
2. Implement command-driven webview launch for active CSV.
3. Build split-pane webview shell with tab skeleton and active tab state.
4. Implement host/webview message bridge for init + dataset load event.
5. Add/adjust smoke tests and run verification commands.

## Milestone notes
- 2026-02-11: Started T-002; task moved to `in_progress`.
- 2026-02-11: Added Node/TypeScript extension scaffold and webview shell.
- 2026-02-11: Implemented host/webview message bridge with `webview/ready` handshake.
- 2026-02-11: Added smoke tests for open command and bridge event emission.

## Patch summary
- Added extension package scaffold (`package.json`, `tsconfig.json`) with build/lint/test scripts.
- Implemented `waveViewer.openViewer` command in `src/extension.ts`:
  - validates active editor and `.csv` extension,
  - opens split-pane webview panel,
  - sends `host/init` and `host/datasetLoaded` after `webview/ready`.
- Added webview shell files:
  - `src/webview/index.html`: two-pane layout, plot tabs container, plot canvas container.
  - `src/webview/styles.css`: responsive split-pane styling.
  - `src/webview/main.ts`: tab skeleton state and active-tab switching, bridge status rendering.
- Added smoke tests in `tests/extension/smoke.test.ts` for command behavior and bridge protocol.

## PR URL
- To be filled from opened PR.

## Verification
- `npm run lint` passed.
- `npm test` passed (`5` tests in `tests/extension/smoke.test.ts`).

## Status request
- Ready for Review (pending PR open and `tasks_state` update).

## Blockers / Questions
- None currently.

## Next steps
- Open PR and set `tasks_state` to `ready_for_review` with PR number.

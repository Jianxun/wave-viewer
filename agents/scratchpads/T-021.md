# T-021 Scratchpad

## Task summary (DoD + verify)
- Add Explorer view context-menu command `Load CSV File...` that opens a file picker and loads one or more CSV files into the side-panel registry.
- Add Explorer view context-menu command `Reload All Files` that reparses all currently loaded CSV files and refreshes tree content.
- Surface actionable errors for parse failures while preserving already-loaded valid datasets.
- Keep command wiring deterministic and covered by extension smoke tests.

Verify:
- `npm run lint`
- `npm test -- tests/extension/smoke.test.ts`

## Read (paths)
- `agents/context/lessons.md`
- `agents/context/contract.md`
- `agents/context/tasks.yaml`
- `agents/context/tasks_state.yaml`
- `agents/context/project_status.md`
- `src/extension.ts`
- `src/extension/signalTree.ts`
- `tests/extension/smoke.test.ts`
- `package.json`

## Plan
- Add/cover command ids and behavior for loading multiple CSV files into loaded-dataset registry.
- Add/cover reload-all behavior that reparses loaded datasets and preserves prior valid state on parse failures.
- Wire commands into activation and Explorer view menus.
- Run verify, update status, open PR.

## Milestone notes
- Intake complete.
- Added smoke-test coverage for load/reload command ids and command behavior (multi-file load, partial failures, reload failure preservation).
- Implemented command factories and activation wiring.
- Added Explorer view title menu entries for `Load CSV File...` and `Reload All Files`.

## Patch summary
- Added new command ids:
  - `waveViewer.signalBrowser.loadCsvFiles`
  - `waveViewer.signalBrowser.reloadAllFiles`
- Added `createLoadCsvFilesCommand`:
  - Opens multi-file CSV picker.
  - Parses and registers each selected file independently.
  - Surfaces per-file actionable errors without aborting other selected files.
- Added `createReloadAllLoadedFilesCommand`:
  - Iterates over loaded dataset paths.
  - Re-parses each file and updates registry per success.
  - Preserves previously loaded datasets when a reload parse fails and reports per-file errors.
- Wired both commands in `activate()` and command registration.
- Added `package.json` contributions for commands, activation events, and Explorer view title menu actions.
- Added/updated smoke tests for command ids and command behavior.

## PR URL
- Pending (set after PR creation).

## Verification
- `npm test -- tests/extension/smoke.test.ts` (pass)
- `npm run lint` (pass)

## Status request (Done / Blocked / In Progress)
- In Progress (ready to open PR)

## Blockers / Questions
- None.

## Next steps
- Commit, push, open PR, then set `tasks_state` to `ready_for_review` with PR number.

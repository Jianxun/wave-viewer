# T-039 â€” Add explicit lane activation intent from lane-container click

## Task summary (DoD + verify)
- Add a new webview intent to set active lane/axis from sidebar lane-container click (`plotId`, `axisId`).
- Handle the intent in host transaction flow and update `viewerState.activeAxisByPlotId` without mutating traces.
- Ensure active-lane state round-trips in snapshot/patch messages and is reflected consistently in sidebar highlighting and quick-add default target.
- Add protocol/runtime validation updates and integration coverage for lane-click activation.

Verify:
- `npm run lint`
- `npm test -- tests/unit/protocol/messages.test.ts tests/extension/smoke.test.ts`

## Read (paths)
- `agents/context/lessons.md`
- `agents/context/contract.md`
- `agents/context/tasks.yaml`
- `agents/context/tasks_state.yaml`
- `agents/context/project_status.md`

## Plan
- Add protocol/runtime and host handler support for a lane-activation intent (`setActiveAxis`).
- Wire sidebar lane-container clicks to emit the new intent from webview.
- Keep host-authoritative roundtrip so active axis is reflected through `host/statePatch`.
- Add protocol + smoke coverage and run DoD verify commands.

## Milestone notes
- Intake complete.
- Added protocol tests for accepting/rejecting `webview/intent/setActiveAxis` payloads.
- Added host transaction handling in open-viewer command flow for `setActiveAxis`.
- Wired lane board active highlighting and lane click -> `setActiveAxis` intent emission.
- Added smoke coverage for host handling and lane-click wiring.

## Patch summary
- Added host-side support for `webview/intent/setActiveAxis` in `createOpenViewerCommand`.
- Added runtime axis-id validation (`yN`) for `setActiveAxis` payload validation.
- Extended extension message types to include `webview/intent/setActiveAxis`.
- Wired `renderSignalList` with `activeAxisId` and `onActivateLane` callback.
- Added lane-container click handling in signal board and active-lane class toggling.
- Added protocol and smoke tests for lane activation intent handling and UI wiring.

## PR URL
- Pending PR creation.

## Verification
- `npm run lint` (pass)
- `npm test -- tests/unit/protocol/messages.test.ts tests/extension/smoke.test.ts` (pass)

## Status request (Done / Blocked / In Progress)
- Done

## Blockers / Questions
- None.

## Next steps
- Open PR and request reviewer pass for `T-039`.

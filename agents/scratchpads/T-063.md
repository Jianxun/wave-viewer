# T-063 Scratchpad

## Task summary (DoD + verify)
- Title: Remove temporary reload workaround branches and align docs to replay-snapshot-only reload path.
- DoD:
  - Remove obsolete reload workaround code paths that attempted partial tuple-cache refresh via heuristic matching.
  - Update README and protocol-oriented docs to distinguish incremental tuple upsert interactions from atomic reload replay snapshots.
  - Re-run focused verification matrix and document expected reload behavior for manual QA.
- Verify:
  - `npm test -- tests/extension/smoke.test.ts`
  - `npm run lint`

## Read (paths)
- `agents/roles/executor.md`
- `agents/context/lessons.md`
- `agents/context/contract.md`
- `agents/context/tasks.yaml`
- `agents/context/tasks_state.yaml`
- `agents/context/project_status.md`
- `src/extension.ts`
- `src/webview/main.ts`
- `README.md`
- `doc/specs/host-webview-protocol.md`
- `doc/specs/wave-viewer-mvp.md`
- `tests/extension/smoke.test.ts`

## Plan
1. Remove remaining reload-era tuple-upsert behavior wording/branches that conflict with replay-snapshot-only reload semantics.
2. Align README and protocol docs with explicit separation of `host/tupleUpsert` (incremental interactions) and `host/replaySnapshot` (reload/import atomic updates).
3. Add manual QA expectations for reload behavior to docs.
4. Run verify matrix and close out task state/PR metadata.

## Milestone notes
- Intake complete; task selected from `ready` and set to `in_progress`.
- Branch created: `feature/T-063-reload-docs-cleanup`.
- Removed reload-time heuristic gating from extension replay fanout path.
- Clarified webview `host/tupleUpsert` status copy to interaction semantics.
- Updated protocol + MVP + README docs for replay snapshot vs tuple-upsert responsibilities.
- Focused verification matrix passed.

## Patch summary
- `src/extension.ts`
  - Removed reload-time heuristic branch that filtered replay publication by parsed trace dataset-path matching.
  - Kept reload handling on atomic replay snapshots (`host/replaySnapshot`) without partial tuple-cache matching logic.
- `src/webview/main.ts`
  - Updated `host/tupleUpsert` bridge status text to `Patched: tuple upsert` to avoid reload-specific semantics.
- `tests/extension/smoke.test.ts`
  - Updated reload replay test fixture to remove heuristic reloaded-path matching branch.
  - Added semantic assertion that tuple-upsert branch uses tuple-upsert status text and not reload wording.
- `README.md`
  - Added manual QA-oriented reload behavior section clarifying replay snapshot vs tuple upsert flows.
- `doc/specs/host-webview-protocol.md`
  - Clarified `host/tupleUpsert` is interaction-incremental only and not the primary reload/import replay transport.
- `doc/specs/wave-viewer-mvp.md`
  - Added explicit tuple-upsert vs replay-snapshot rules and manual QA expectations for reload behavior.

## PR URL
- Pending PR creation.

## Verification
- `npm test -- tests/extension/smoke.test.ts` (pass)
- `npm run lint` (pass)

## Status request
- In Progress (ready for PR open and status transition).

## Blockers / Questions
- None.

## Next steps
- Push branch and open PR.
- Set `T-063` to `ready_for_review` with PR number and rerun task-state linter.
